<!DOCTYPE html>
<html>
    <head>
        <title>Text2Speech!</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='styles/style.css') }}">
    </head>
    <body>
        <h1>Welcome to Text2Speech!</h1>
        <h2>Choose a document from your files to start!</h2>
        <form action="{{ url_for('upload_file') }}" method='POST' enctype='multipart/form-data'>
            <div class="button-container">
                <input type='file' id='file' name='file' accept='.txt, .docx' required hidden>
                <label for='file' class='file-label'>Choose a file</label>
                <input type='submit' value='Upload' id="upload-btn">
            </div>

            <div class="control-group">
                <!--voice selection -->
                <label for='voice'>Voice:</label>
                <select name="voice" id="voice">
                    <option value="female">Female</option>
                    <option value="Male">Male</option>
                </select>

                <!--Speed control-->
                <label for="rate">Speed:</label>
                <select name="rate" id="rate">
                    <option value="50">0.5x</option>
                    <option value="100" selected>1.0x</option>
                    <option value="150">1.5x</option>
                    <option value="200">2.0x</option>
                </select>
            </div>
        </form>
        {% if content %}
        <h3>Uploaded Text:</h3>
        <pre>{{ content }}</pre>

        <h3> Generated Audio:</h3>
        <audio controls>
            <source src="{{ url_for('static', filename=audio_path) }}" type="audio/mpeg">
            Your browser does not support the audio element.
        </audio>
        {% endif %}

        <script>
            document.querySelector("form").addEventListener("submit", function(event) {
                const fileInput = document.getElementById("file");
                const file = fileInput.files[0];
                if (!file) {
                    event.preventDefault();
                    alert("Please select a file to upload.");
                }
                const allowedTypes = ["text/plain", "application/vnd.openxmlformats-officedocument.wordprocessingml.document"];
                if (!allowedTypes.includes(file.type)) {
                    event.preventDefault();
                    alert("Please upload a valid .txt or .docx file.");
                }
            });

            const rateSelect = document.getElementById("rate");
            const rateDisplay = document.getElementById("rate-display");
            rateSelect.addEventListener("input", function() {

                const rateMap = {
                    "50": "0.5x",
                    "100": "1.0x",
                    "150": "1.5x",
                    "200": "2.0x"
                };
                rateDisplay.textContent = rateMap[this.value] || "1.0x";
            })
        </script>

       
    </body>
        
</html>